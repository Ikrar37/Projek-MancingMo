{% extends 'base.html' %}
{% load static %}

{% block title %}Verifikasi Email - MancingMo{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/verify_email.css' %}">
{% endblock %}

{% block content %}
<!-- Verify Email Section -->
<div class="verify-container">
    <div class="verify-image">
        <div class="verify-image-content">
            <h2>Hampir Selesai!</h2>
            <p>Verifikasi email Anda untuk mengaktifkan akun dan mulai berbelanja peralatan pancing terbaik di MancingMo</p>
            <div class="verify-icon">
                <svg width="120" height="120" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                    <path d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"/>
                    <path d="M9 11l2 2 4-4" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
            </div>
        </div>
    </div>

    <div class="verify-form-container">
        <div class="verify-header">
            <h1>Verifikasi Email</h1>
            <p>Kode verifikasi telah dikirim ke <strong>{{ user.email }}</strong></p>
            <p class="check-email">Silakan cek inbox atau folder spam email Anda</p>
        </div>

        <form method="post" id="verifyForm">
            {% csrf_token %}
            
            <div class="form-group">
                <label for="code">Kode Verifikasi (6 digit) *</label>
                <input 
                    type="text" 
                    id="code" 
                    name="code" 
                    placeholder="Masukkan 6 digit kode"
                    maxlength="6"
                    pattern="[0-9]{6}"
                    required
                    autofocus
                    inputmode="numeric"
                >
                <div class="input-hint">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10"/>
                        <line x1="12" y1="16" x2="12" y2="12"/>
                        <line x1="12" y1="8" x2="12.01" y2="8"/>
                    </svg>
                    <span>Kode terdiri dari 6 digit angka</span>
                </div>
            </div>

            <button type="submit" class="btn-verify" id="verifyBtn">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polyline points="20 6 9 17 4 12"/>
                </svg>
                Verifikasi Email
            </button>
        </form>

        <div class="resend-section">
            <p class="resend-text">Tidak menerima email?</p>
            <a href="{% url 'resend_verification_code' username=user.username %}" class="btn-resend">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polyline points="23 4 23 10 17 10"/>
                    <path d="M20.49 15a9 9 0 1 1-2.12-9.36L23 10"/>
                </svg>
                Kirim Ulang Kode
            </a>
        </div>

        <div class="help-section">
            <div class="help-item">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M22 16.92v3a2 2 0 01-2.18 2 19.79 19.79 0 01-8.63-3.07 19.5 19.5 0 01-6-6 19.79 19.79 0 01-3.07-8.67A2 2 0 014.11 2h3a2 2 0 012 1.72 12.84 12.84 0 00.7 2.81 2 2 0 01-.45 2.11L8.09 9.91a16 16 0 006 6l1.27-1.27a2 2 0 012.11-.45 12.84 12.84 0 002.81.7A2 2 0 0122 16.92z"/>
                </svg>
                <div>
                    <strong>Butuh Bantuan?</strong>
                    <p>Hubungi support kami</p>
                </div>
            </div>
            
            <div class="help-item">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/>
                    <polyline points="22,6 12,13 2,6"/>
                </svg>
                <div>
                    <strong>Cek Email</strong>
                    <p>Pastikan email dari MancingMo tidak masuk spam</p>
                </div>
            </div>
        </div>

        <div class="login-link">
            Sudah punya akun? <a href="{% url 'login' %}">Masuk Sekarang</a>
        </div>
    </div>
</div>

<script>
// Auto-format input untuk hanya angka
document.getElementById('code').addEventListener('input', function(e) {
    this.value = this.value.replace(/[^0-9]/g, '');
});

// Auto-submit saat 6 digit terisi (opsional)
document.getElementById('code').addEventListener('input', function(e) {
    if (this.value.length === 6) {
        // Bisa uncomment ini untuk auto-submit
        // document.getElementById('verifyForm').submit();
    }
});

// Form validation
document.getElementById('verifyForm').addEventListener('submit', function(e) {
    const code = document.getElementById('code').value;
    
    if (code.length !== 6) {
        e.preventDefault();
        alert('Kode verifikasi harus 6 digit!');
        return false;
    }
    
    if (!/^\d+$/.test(code)) {
        e.preventDefault();
        alert('Kode verifikasi hanya boleh berisi angka!');
        return false;
    }
    
    // Disable button to prevent double submit
    const btn = document.getElementById('verifyBtn');
    btn.disabled = true;
    btn.innerHTML = '<span>Memverifikasi...</span>';
});
</script>
{% endblock %}